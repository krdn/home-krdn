---
phase: 33-port-registry-system
plan: 03
type: execute
depends_on: ["33-02"]
files_modified: [src/app/admin/ports/page.tsx, src/components/ports/PortList.tsx, src/components/ports/PortForm.tsx, src/hooks/usePorts.ts]
---

<objective>
Port Registry 관리 UI 구현

Purpose: Admin에서 포트 레지스트리를 관리할 수 있는 UI를 제공합니다.
Output: /admin/ports 페이지, 포트 목록/생성/수정/삭제 UI
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/33-port-registry-system/33-02-SUMMARY.md
@src/app/admin/page.tsx
@src/components/admin/AdminSidebar.tsx

**Tech stack available:** React 19, TanStack Query, Tailwind CSS, Radix UI, Framer Motion
**Established patterns:** Admin 페이지 레이아웃, useMutation/useQuery, Dialog 모달
</context>

<tasks>

<task type="auto">
  <name>Task 1: 포트 데이터 훅 및 목록 컴포넌트</name>
  <files>src/hooks/usePorts.ts, src/components/ports/PortList.tsx</files>
  <action>
**usePorts 훅 구현:**
- usePortsQuery(): 포트 목록 조회 (필터 지원)
- usePortQuery(id): 단일 포트 조회
- useCreatePort(): 포트 생성 mutation
- useUpdatePort(): 포트 수정 mutation
- useDeletePort(): 포트 삭제 mutation
- useCheckPort(): 포트 충돌 검사

TanStack Query 패턴 사용, queryKey: ['ports', filters]

**PortList 컴포넌트:**
- 테이블 형식 (포트, 이름, 환경, 상태, URL, 액션)
- 필터링: 카테고리, 환경, 상태
- 검색: 이름/설명 검색
- 액션: 수정, 삭제 버튼
- 빈 상태 UI

기존 ContainerList.tsx 스타일 참고.
  </action>
  <verify>usePorts import 후 타입 체크</verify>
  <done>포트 데이터 훅 완성, PortList 컴포넌트 렌더링</done>
</task>

<task type="auto">
  <name>Task 2: 포트 생성/수정 폼 컴포넌트</name>
  <files>src/components/ports/PortForm.tsx</files>
  <action>
**PortForm 컴포넌트 (Dialog 기반):**
- 모드: create / edit
- 필드: 포트번호, 프로젝트이름, 설명, 프로토콜, 환경, 상태, URL들, 카테고리
- 포트 번호 입력 시 실시간 충돌 검사 (debounce 300ms)
- 충돌 시 경고 표시 ("포트 3000은 'home-krdn'에서 사용 중입니다")
- 제출 시 validation 에러 표시

Radix Dialog + react-hook-form 또는 controlled form 사용.
tailwind 스타일링, 기존 AlertRuleForm 참고.
  </action>
  <verify>PortForm 렌더링 및 폼 제출 동작</verify>
  <done>PortForm 생성/수정 모드 동작, 충돌 검사 표시</done>
</task>

<task type="auto">
  <name>Task 3: Admin 포트 관리 페이지</name>
  <files>src/app/admin/ports/page.tsx, src/components/admin/AdminSidebar.tsx</files>
  <action>
**Admin 포트 페이지:**
- 경로: /admin/ports
- 레이아웃: 기존 admin 페이지 스타일
- 헤더: "포트 레지스트리" + "포트 추가" 버튼
- 본문: PortList + PortForm (Dialog)
- 권한: ADMIN만 접근 (RBAC)

**AdminSidebar 업데이트:**
- DevOps 섹션 추가 또는 기존 메뉴에 "포트 관리" 링크 추가
- 아이콘: Network 또는 Server (lucide-react)

페이지는 'use client' 디렉티브 필요.
  </action>
  <verify>브라우저에서 /admin/ports 접근 및 기능 동작 확인</verify>
  <done>Admin 포트 관리 페이지 완성, 사이드바 링크 추가</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>포트 레지스트리 관리 UI (목록, 생성, 수정, 삭제, 충돌 검사)</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3100/admin/ports (로그인 필요)
    3. "포트 추가" 버튼 클릭 → 폼 Dialog 열림
    4. 포트 3000 입력 → 충돌 검사 동작 확인 (기존 포트 있으면 경고)
    5. 새 포트 (예: 4000) 등록 → 목록에 추가됨
    6. 등록된 포트 수정/삭제 동작 확인
    7. 필터링 (환경, 카테고리) 동작 확인
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] /admin/ports 페이지 접근 가능
- [ ] 포트 목록 조회 동작
- [ ] 포트 생성 (충돌 검사 포함) 동작
- [ ] 포트 수정/삭제 동작
- [ ] 필터링/검색 동작
- [ ] AdminSidebar에 메뉴 추가됨
- [ ] RBAC 권한 검사 동작 (ADMIN만)
</verification>

<success_criteria>

- /admin/ports 관리 페이지 완성
- 포트 CRUD UI 동작
- 실시간 포트 충돌 검사 동작
- 필터링/검색 기능 동작
- AdminSidebar 메뉴 업데이트
- Phase 33 Port Registry System 완료
</success_criteria>

<output>
After completion, create `.planning/phases/33-port-registry-system/33-03-SUMMARY.md`
</output>
