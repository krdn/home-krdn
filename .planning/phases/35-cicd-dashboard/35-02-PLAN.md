---
phase: 35-cicd-dashboard
plan: 02
type: execute
wave: 2
depends_on: ["35-01"]
files_modified:
  - src/components/github/WorkflowList.tsx
  - src/components/github/WorkflowRunList.tsx
  - src/components/github/WorkflowStatusBadge.tsx
  - src/hooks/useGitHub.ts
  - src/app/admin/github/page.tsx
autonomous: true

must_haves:
  truths:
    - "사용자가 특정 레포지토리의 워크플로우 목록을 볼 수 있다"
    - "사용자가 워크플로우 실행 기록을 볼 수 있다"
    - "사용자가 실행 상태(성공/실패/진행중)를 시각적으로 구분할 수 있다"
    - "사용자가 실행 기록에서 GitHub Actions로 이동할 수 있다"
  artifacts:
    - path: "src/components/github/WorkflowList.tsx"
      provides: "워크플로우 목록 컴포넌트"
      min_lines: 60
    - path: "src/components/github/WorkflowRunList.tsx"
      provides: "워크플로우 실행 기록 컴포넌트"
      min_lines: 80
    - path: "src/components/github/WorkflowStatusBadge.tsx"
      provides: "상태별 색상 배지 컴포넌트"
      min_lines: 30
  key_links:
    - from: "WorkflowList.tsx"
      to: "/api/github/repos/[owner]/[repo]/workflows"
      via: "GET 요청으로 워크플로우 조회"
      pattern: "fetch.*workflows"
    - from: "WorkflowRunList.tsx"
      to: "/api/github/repos/[owner]/[repo]/runs"
      via: "GET 요청으로 실행 기록 조회"
      pattern: "fetch.*runs"
---

<objective>
GitHub Actions 워크플로우 및 실행 기록 시각화 대시보드 구현

Purpose: 선택한 레포지토리의 CI/CD 파이프라인 상태를 실시간으로 파악할 수 있는 대시보드 제공
Output: 워크플로우 목록, 실행 기록, 상태별 시각화가 포함된 CI/CD 대시보드
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 35-01 결과물 참조
@.planning/phases/35-cicd-dashboard/35-01-SUMMARY.md

# Phase 34 API 참조
@src/types/github.ts
@src/lib/github-service.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: useWorkflows 훅 추가</name>
  <files>src/hooks/useGitHub.ts</files>
  <action>
    기존 useGitHub.ts에 워크플로우 관련 훅 추가:

    1. useWorkflows(owner, repo) 훅:
       - GET /api/github/repos/{owner}/{repo}/workflows
       - GitHubWorkflow[] 반환
       - 로딩/에러 상태 관리

    2. useWorkflowRuns(owner, repo, filter?) 훅:
       - GET /api/github/repos/{owner}/{repo}/runs
       - filter: WorkflowRunFilter (status, branch, event 등)
       - GitHubWorkflowRun[] 반환
       - 페이지네이션 지원
       - 자동 새로고침 옵션 (refreshInterval)

    타입 임포트: GitHubWorkflow, GitHubWorkflowRun, WorkflowRunFilter
  </action>
  <verify>tsc --noEmit 통과, 훅 export 확인</verify>
  <done>useWorkflows, useWorkflowRuns 훅 추가됨</done>
</task>

<task type="auto">
  <name>Task 2: WorkflowStatusBadge 컴포넌트 구현</name>
  <files>src/components/github/WorkflowStatusBadge.tsx</files>
  <action>
    워크플로우 실행 상태별 시각적 배지 컴포넌트:

    1. 상태별 스타일:
       - success: 녹색 배경 + Check 아이콘
       - failure: 빨간색 배경 + X 아이콘
       - in_progress: 파란색 배경 + Loader 아이콘 (애니메이션)
       - queued/waiting: 노란색 배경 + Clock 아이콘
       - cancelled: 회색 배경 + Ban 아이콘
       - skipped: 회색 배경 + SkipForward 아이콘

    2. Props:
       - status: GitHubWorkflowRun['status']
       - conclusion: GitHubWorkflowRun['conclusion']
       - size?: 'sm' | 'md' | 'lg'

    Tailwind 클래스 사용, 애니메이션은 animate-spin
    접근성: aria-label로 상태 텍스트 제공
  </action>
  <verify>컴포넌트 빌드 성공, 모든 상태 스타일 정의됨</verify>
  <done>WorkflowStatusBadge 상태별 시각화 완료</done>
</task>

<task type="auto">
  <name>Task 3: WorkflowList 컴포넌트 구현</name>
  <files>src/components/github/WorkflowList.tsx</files>
  <action>
    레포지토리 워크플로우 목록 컴포넌트:

    1. 워크플로우 카드/리스트:
       - name, path (.github/workflows/xxx.yml)
       - state (active/disabled) 배지
       - GitHub Actions 페이지 링크

    2. 워크플로우 선택:
       - 클릭 시 해당 워크플로우 실행 기록 표시
       - selectedWorkflow state 콜백

    3. 빈 상태:
       - 워크플로우 없음 메시지
       - GitHub Actions 설정 가이드 링크

    Props:
    - owner: string
    - repo: string
    - onWorkflowSelect?: (workflow: GitHubWorkflow) => void

    useWorkflows 훅 활용
  </action>
  <verify>컴포넌트 빌드 성공, 워크플로우 목록 렌더링</verify>
  <done>WorkflowList 워크플로우 목록 + 선택 기능 완료</done>
</task>

<task type="auto">
  <name>Task 4: WorkflowRunList 컴포넌트 구현</name>
  <files>src/components/github/WorkflowRunList.tsx</files>
  <action>
    워크플로우 실행 기록 목록 컴포넌트:

    1. 실행 기록 테이블:
       - WorkflowStatusBadge (상태)
       - name (워크플로우 이름)
       - head_branch (브랜치)
       - head_sha (커밋 SHA, 7자리 truncate)
       - created_at (상대 시간: "2분 전", "1시간 전")
       - duration (created_at → updated_at)
       - GitHub Actions 링크 (외부 링크 아이콘)

    2. 필터 UI:
       - status 드롭다운 (completed, in_progress, queued 등)
       - branch 입력
       - 새로고침 버튼

    3. 타임라인 뷰 (선택적):
       - 최근 실행을 시간순 타임라인으로 표시
       - 성공/실패 색상 구분

    Props:
    - owner: string
    - repo: string
    - workflowId?: number (특정 워크플로우 필터)

    useWorkflowRuns 훅 활용
    상대 시간 포맷: date-fns formatDistanceToNow 또는 직접 구현
  </action>
  <verify>컴포넌트 빌드 성공, 실행 기록 목록 렌더링</verify>
  <done>WorkflowRunList 실행 기록 + 상태 시각화 완료</done>
</task>

<task type="auto">
  <name>Task 5: GitHub Admin 페이지 워크플로우 섹션 통합</name>
  <files>src/app/admin/github/page.tsx</files>
  <action>
    /admin/github 페이지에 워크플로우 대시보드 통합:

    1. 레포 선택 시 워크플로우 섹션 표시:
       - selectedRepo 상태로 조건부 렌더링
       - WorkflowList + WorkflowRunList

    2. 레이아웃:
       - 왼쪽: RepoList (레포 선택)
       - 오른쪽: 워크플로우 대시보드 (선택된 레포)
       - 반응형: 모바일에서는 세로 배치

    3. 상태 통계 (선택적):
       - 최근 실행 성공률
       - 평균 실행 시간

    Dynamic Import: WorkflowList, WorkflowRunList 지연 로딩
    뒤로가기: 레포 선택 해제 버튼
  </action>
  <verify>npm run build 성공, 레포 선택 → 워크플로우 대시보드 표시</verify>
  <done>/admin/github 페이지에서 CI/CD 대시보드 완전 동작</done>
</task>

</tasks>

<verification>
Plan 완료 전 확인:
- [ ] npm run build 성공 (TypeScript 에러 없음)
- [ ] 레포 선택 시 워크플로우 목록 표시
- [ ] 워크플로우 실행 기록 목록 표시
- [ ] 상태별 색상 배지 올바르게 표시 (success=녹색, failure=빨간색 등)
- [ ] GitHub Actions 페이지 링크 동작
- [ ] 필터 기능 동작 (status, branch)
</verification>

<success_criteria>
- 모든 태스크 완료
- useWorkflows, useWorkflowRuns 훅 정상 동작
- WorkflowStatusBadge 모든 상태 시각화
- WorkflowList 워크플로우 목록 표시
- WorkflowRunList 실행 기록 + 타임라인 표시
- /admin/github 페이지 통합 완료
</success_criteria>

<output>
완료 후 `.planning/phases/35-cicd-dashboard/35-02-SUMMARY.md` 생성
</output>
