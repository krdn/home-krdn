---
phase: 35-cicd-dashboard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/admin/github/page.tsx
  - src/components/github/GitHubSetup.tsx
  - src/components/github/RepoList.tsx
  - src/hooks/useGitHub.ts
autonomous: true

must_haves:
  truths:
    - "사용자가 GitHub 토큰을 등록할 수 있다"
    - "사용자가 연결된 GitHub 계정 정보를 볼 수 있다"
    - "사용자가 자신의 레포지토리 목록을 볼 수 있다"
    - "토큰이 없으면 설정 폼이 표시된다"
  artifacts:
    - path: "src/app/admin/github/page.tsx"
      provides: "GitHub Admin 페이지"
      min_lines: 50
    - path: "src/components/github/GitHubSetup.tsx"
      provides: "토큰 설정 + 계정 정보 컴포넌트"
      min_lines: 80
    - path: "src/components/github/RepoList.tsx"
      provides: "레포지토리 목록 컴포넌트"
      min_lines: 60
    - path: "src/hooks/useGitHub.ts"
      provides: "GitHub API 통신 훅"
      exports: ["useGitHubSettings", "useRepositories"]
  key_links:
    - from: "GitHubSetup.tsx"
      to: "/api/github"
      via: "POST 요청으로 토큰 등록"
      pattern: "fetch.*api/github.*POST"
    - from: "RepoList.tsx"
      to: "/api/github/repos"
      via: "GET 요청으로 레포 목록 조회"
      pattern: "fetch.*api/github/repos"
---

<objective>
GitHub 연동 설정 UI 및 레포지토리 목록 조회 기능 구현

Purpose: Phase 34에서 구현한 GitHub API를 활용하여 Admin에서 GitHub 토큰 관리 및 레포지토리 조회 UI를 제공
Output: /admin/github 페이지에서 토큰 등록, 계정 정보 확인, 레포 목록 조회 가능
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 34 결과물 참조 (GitHub API)
@.planning/phases/34-github-integration/34-02-SUMMARY.md

# 기존 Admin 페이지 패턴 참조
@src/app/admin/ports/page.tsx
@src/types/github.ts
@src/lib/github-service.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: useGitHub 훅 구현</name>
  <files>src/hooks/useGitHub.ts</files>
  <action>
    GitHub API 통신 훅 구현:

    1. useGitHubSettings() 훅:
       - GET /api/github로 설정 조회
       - POST /api/github로 토큰 등록/업데이트
       - DELETE /api/github로 연동 해제
       - SWR 또는 useState/useEffect 패턴 사용 (기존 프로젝트 패턴 따름)
       - 로딩/에러 상태 관리

    2. useRepositories() 훅:
       - GET /api/github/repos로 레포 목록 조회
       - filter 파라미터 지원 (type, sort, direction, per_page)
       - 페이지네이션 지원

    타입 임포트: @/types/github의 GitHubSettingsDto, GitHubRepo, RepositoryFilter 사용
    에러 처리: 기존 error-handler 패턴 따름 (try/catch, 사용자 친화적 메시지)
  </action>
  <verify>tsc --noEmit 통과, 훅 export 확인</verify>
  <done>useGitHubSettings, useRepositories 훅 export됨</done>
</task>

<task type="auto">
  <name>Task 2: GitHubSetup 컴포넌트 구현</name>
  <files>src/components/github/GitHubSetup.tsx</files>
  <action>
    GitHub 토큰 설정 및 계정 정보 표시 컴포넌트:

    1. 토큰 미등록 상태:
       - Personal Access Token 입력 폼
       - 토큰 형식 안내 (ghp_ 또는 github_pat_ 접두사)
       - 토큰 등록 버튼

    2. 토큰 등록 상태:
       - GitHub 사용자 정보 표시 (아바타, username)
       - hasToken: true 표시 (토큰 값은 미노출)
       - 연동 해제 버튼 (확인 다이얼로그)

    스타일링: 기존 Admin 페이지 패턴 (Card, Button, Input 컴포넌트 사용)
    아이콘: lucide-react (Github, User, Trash2, Check 등)

    useGitHubSettings 훅 활용
  </action>
  <verify>컴포넌트 빌드 성공, TypeScript 에러 없음</verify>
  <done>GitHubSetup 컴포넌트 구현됨, 토큰 등록/해제 UI 제공</done>
</task>

<task type="auto">
  <name>Task 3: RepoList 컴포넌트 구현</name>
  <files>src/components/github/RepoList.tsx</files>
  <action>
    레포지토리 목록 컴포넌트:

    1. 레포지토리 목록 테이블/카드:
       - name, description, language, stars, forks
       - private/public 배지
       - pushed_at (최근 푸시 시간)
       - GitHub 링크 (외부 링크 아이콘)

    2. 필터 UI:
       - type 드롭다운 (all, owner, public, private)
       - sort 드롭다운 (updated, created, pushed)
       - 검색 입력 (클라이언트 필터링)

    3. 빈 상태:
       - 레포지토리 없음 메시지
       - GitHub 토큰 미등록 시 설정 유도

    useRepositories 훅 활용
    가상화: 레포 수가 많을 경우 @tanstack/react-virtual 고려 (기존 패턴)
    레포 클릭 시 상세/워크플로우 보기로 이동 (onClick 콜백)
  </action>
  <verify>컴포넌트 빌드 성공, 레포 목록 렌더링</verify>
  <done>RepoList 컴포넌트 구현됨, 필터/목록 UI 제공</done>
</task>

<task type="auto">
  <name>Task 4: GitHub Admin 페이지 구현</name>
  <files>src/app/admin/github/page.tsx</files>
  <action>
    /admin/github 페이지 구현:

    1. 페이지 레이아웃:
       - 기존 Admin 페이지 패턴 따름 (ports/page.tsx 참조)
       - AdminOnly 권한 가드
       - 페이지 헤더 (아이콘 + 제목 + 설명)

    2. 조건부 렌더링:
       - 토큰 미등록: GitHubSetup만 표시
       - 토큰 등록됨: GitHubSetup (계정 정보) + RepoList (레포 목록)

    3. 선택된 레포 상태 관리:
       - selectedRepo state
       - 레포 클릭 시 상세/워크플로우 섹션 표시 (Plan 02에서 구현)

    Dynamic Import: GitHubSetup, RepoList 지연 로딩 (기존 패턴)
    아이콘: Github (lucide-react)
  </action>
  <verify>npm run build 성공, /admin/github 페이지 접근 가능</verify>
  <done>/admin/github 페이지에서 GitHub 설정 + 레포 목록 조회 가능</done>
</task>

</tasks>

<verification>
Plan 완료 전 확인:
- [ ] npm run build 성공 (TypeScript 에러 없음)
- [ ] /admin/github 페이지 접근 가능
- [ ] 토큰 미등록 시 설정 폼 표시
- [ ] 토큰 등록 후 계정 정보 + 레포 목록 표시
- [ ] 에러 상태 적절히 표시 (토큰 만료, rate limit 등)
</verification>

<success_criteria>
- 모든 태스크 완료
- useGitHubSettings, useRepositories 훅 정상 동작
- GitHubSetup 컴포넌트 토큰 등록/해제 동작
- RepoList 컴포넌트 레포 목록 + 필터 동작
- /admin/github 페이지 통합 완료
</success_criteria>

<output>
완료 후 `.planning/phases/35-cicd-dashboard/35-01-SUMMARY.md` 생성
</output>
