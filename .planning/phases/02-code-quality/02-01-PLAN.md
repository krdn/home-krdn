---
phase: 02-code-quality
plan: 01
type: execute
depends_on: []
files_modified: [src/lib/system.ts, src/app/api/system/route.ts]
---

<objective>
중복된 유틸리티 함수(formatBytes, formatUptime)를 통합하여 코드 일관성을 확보합니다.

Purpose: 동일한 함수가 두 곳에 존재하면 유지보수가 어려워지고, 동작이 달라질 위험이 있습니다.
Output: 단일 유틸리티 함수로 통합된 깔끔한 코드베이스
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/CONCERNS.md

**중복 현황:**
- `src/lib/utils.ts`: formatBytes (8-15줄), formatUptime (17-25줄) - decimals 파라미터 있음
- `src/lib/system.ts`: formatBytes (132-140줄), formatUptime (145-156줄) - decimals 없음
- `src/app/api/system/route.ts`에서 system.ts 버전 import 중

**선택 기준:**
- `utils.ts` 버전이 더 유연함 (decimals 파라미터)
- `utils.ts`가 범용 유틸리티의 적합한 위치
</context>

<tasks>

<task type="auto">
  <name>Task 1: system.ts에서 중복 함수 제거</name>
  <files>src/lib/system.ts</files>
  <action>
1. `formatBytes` 함수 정의 삭제 (132-140줄)
2. `formatUptime` 함수 정의 삭제 (145-156줄)
3. 파일 상단에 import 추가: `import { formatBytes, formatUptime } from './utils';`
4. `getQuickStats()`에서 사용하는 `formatUptime`은 import된 함수로 자동 연결됨
5. export 문에서 해당 함수들 제거 (더 이상 이 파일에서 export하지 않음)

**주의:** getQuickStats() 내부에서 formatUptime을 사용하므로 import는 필수
  </action>
  <verify>TypeScript 컴파일 에러 없음: `npx tsc --noEmit`</verify>
  <done>system.ts에서 중복 함수 제거되고, utils.ts에서 import됨</done>
</task>

<task type="auto">
  <name>Task 2: API route import 경로 변경</name>
  <files>src/app/api/system/route.ts</files>
  <action>
1. 현재 import: `import { getSystemMetrics, formatBytes, formatUptime } from '@/lib/system';`
2. 변경 후:
   - `import { getSystemMetrics } from '@/lib/system';`
   - `import { formatBytes, formatUptime } from '@/lib/utils';`

**이유:** formatBytes, formatUptime은 이제 utils.ts에서만 export됨
  </action>
  <verify>`npm run build` 성공</verify>
  <done>API route가 올바른 경로에서 함수를 import</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npx tsc --noEmit` 성공 (TypeScript 에러 없음)
- [ ] `npm run build` 성공
- [ ] `npm run lint` 경고/에러 없음
- [ ] formatBytes, formatUptime이 src/lib/utils.ts에서만 export됨
</verification>

<success_criteria>

- system.ts에서 중복 함수 제거됨
- API route에서 올바른 경로로 import
- 빌드 및 타입체크 통과
</success_criteria>

<output>
After completion, create `.planning/phases/02-code-quality/02-01-SUMMARY.md`
</output>
