---
phase: 14-project-admin-crud
plan: 02
subsystem: project-scanner
tags: [project-management, file-system, import, api, admin-ui]

# Dependency graph
requires:
  - phase: 14-01
    provides: [Project CRUD API, Admin Projects Page, ProjectForm component]
provides:
  - 프로젝트 스캔 서비스 (scanProjects, isPathAllowed)
  - 스캔 API (/api/projects/scan)
  - 임포트 API (/api/projects/import)
  - Admin 스캔 탭 (ProjectScanner 컴포넌트)
  - 공개 페이지 API 연동
  - data/projects.json 데이터 저장소
affects: [project-management, admin-ui, public-pages]

# Tech tracking
tech-stack:
  added: [server-only]
  patterns:
    - Server-only file system operations
    - Package.json metadata extraction
    - Git remote URL parsing
    - Category inference from folder structure
---

# Phase 14-02: Project Folder Scanner

## Goal

~/projects 폴더에서 개발 프로젝트를 스캔하여 Admin UI에서 선택적으로 등록할 수 있는 기능 구현

## Context

### 문제점
- 신규 프로젝트를 수동으로 하나씩 등록해야 함
- package.json, README 등 메타데이터를 일일이 입력해야 함
- 기존 프로젝트 현황 파악이 어려움

### 해결책
- 파일시스템 스캔으로 프로젝트 자동 발견
- 메타데이터 자동 추출 (package.json, git, README)
- 일괄 또는 선택적 등록 UI 제공

## Tasks

### Task 1: 데이터 저장소 마이그레이션
**Goal:** config/projects.ts → data/projects.json 전환

**Files:**
- `data/projects.json` - JSON 기반 프로젝트 데이터
- `src/lib/projects.ts` - CRUD 함수 (파일 기반)

**Details:**
- 기존 5개 프로젝트 데이터 마이그레이션
- JSON 파일 기반 읽기/쓰기 구현
- createProject, updateProject, deleteProject 함수

**Commit:** `feat(14): 프로젝트 데이터 JSON 저장소 마이그레이션`

---

### Task 2: 프로젝트 스캔 서비스 구현
**Goal:** 파일시스템 프로젝트 탐색 라이브러리

**Files:**
- `src/lib/project-scanner.ts` - 스캔 로직

**Details:**
- `scanProjects(basePath, maxDepth)`: 프로젝트 목록 반환
- `isPathAllowed(path)`: 경로 화이트리스트 검증
- 프로젝트 감지: package.json 또는 .git 존재
- 무시 패턴: node_modules, .git, .next 등

**Commit:** `feat(14): 프로젝트 스캔 서비스 구현`

---

### Task 3: 스캔 API 엔드포인트
**Goal:** REST API로 스캔 기능 노출

**Files:**
- `src/app/api/projects/scan/route.ts`

**Details:**
- `GET /api/projects/scan?basePath=...&maxDepth=3`
- 인증 및 쓰기 권한 필요
- 스캔 결과: 프로젝트 목록 + 등록 여부 표시

**Commit:** `feat(14): 프로젝트 스캔 API 구현`

---

### Task 4: 임포트 API 엔드포인트
**Goal:** 스캔된 프로젝트를 시스템에 등록

**Files:**
- `src/app/api/projects/import/route.ts`

**Details:**
- `POST /api/projects/import { path, overrides? }`
- 메타데이터 자동 추출:
  - package.json: name, description, dependencies (→ techStack)
  - .git: remote URL, 첫 커밋 날짜 (→ startDate)
  - README.md: features 섹션, demo URL
- Services 자동 등록 (연동)
- 슬러그 중복 검사

**Commit:** `feat(14): 프로젝트 임포트 API 구현`

---

### Task 5: Admin 스캔 탭 UI
**Goal:** 폴더 스캔 및 일괄 등록 UI

**Files:**
- `src/components/admin/ProjectScanner.tsx`
- `src/app/admin/projects/page.tsx` - 탭 추가

**Details:**
- 스캔 경로 입력 + 스캔 버튼
- 스캔 결과 목록 (체크박스 선택)
- 등록/미등록 상태 표시
- 개별 등록 또는 일괄 등록

**Commit:** `feat(14): Admin 프로젝트 스캐너 UI 구현`

---

### Task 6: 공개 페이지 API 연동
**Goal:** config/projects.ts → API 호출로 전환

**Files:**
- `src/app/projects/page.tsx` - API 연동

**Details:**
- `fetch('/api/projects')` 사용
- 로딩/에러 상태 처리
- 기존 필터링/검색 기능 유지

**Commit:** `feat(14): 공개 프로젝트 페이지 API 연동`

---

## Verification

- [ ] `npm run build` 성공
- [ ] `/admin/projects` → "폴더에서 가져오기" 탭 표시
- [ ] 스캔 → 프로젝트 목록 표시
- [ ] 등록 버튼 → 프로젝트 생성 확인
- [ ] `/projects` 페이지에서 등록된 프로젝트 표시

## Dependencies

- Phase 14-01: Project CRUD API 완료 필요

## Risks

- 경로 탈출 공격: `..` 포함 경로 차단
- 대용량 스캔: maxDepth 제한 (기본 3)
- 메타데이터 파싱 실패: 개별 항목 무시하고 계속 진행
