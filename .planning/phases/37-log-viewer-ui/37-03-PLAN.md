---
phase: 37-log-viewer-ui
plan: 03
type: execute
wave: 2
depends_on: ["37-01", "37-02"]
files_modified:
  - src/components/logs/LogViewer.tsx
  - src/components/logs/LogStats.tsx
  - src/app/admin/logs/page.tsx
autonomous: false

must_haves:
  truths:
    - "사용자가 로그 뷰어 페이지에서 로그 목록을 볼 수 있다"
    - "사용자가 필터로 소스/레벨/검색어를 적용할 수 있다"
    - "사용자가 실시간 스트리밍 모드를 켜고 끌 수 있다"
    - "로그 통계(소스별/레벨별 개수)를 볼 수 있다"
  artifacts:
    - path: "src/components/logs/LogViewer.tsx"
      provides: "로그 뷰어 통합 컴포넌트"
      exports: ["LogViewer"]
    - path: "src/components/logs/LogStats.tsx"
      provides: "로그 통계 컴포넌트"
      exports: ["LogStats"]
    - path: "src/app/admin/logs/page.tsx"
      provides: "Admin 로그 페이지 (기존 교체)"
      min_lines: 50
  key_links:
    - from: "src/components/logs/LogViewer.tsx"
      to: "useLogs"
      via: "훅 호출"
      pattern: "useLogs\\("
    - from: "src/components/logs/LogViewer.tsx"
      to: "useLogStream"
      via: "훅 호출"
      pattern: "useLogStream\\("
    - from: "src/app/admin/logs/page.tsx"
      to: "LogViewer"
      via: "컴포넌트 import"
      pattern: "import.*LogViewer"
---

<objective>
LogViewer 통합 컴포넌트 및 Admin 로그 페이지 교체

Purpose: 37-01과 37-02에서 만든 훅과 컴포넌트를 통합하여 완전한 로그 뷰어를 구성하고, 기존 더미 페이지를 교체합니다.
Output: LogViewer, LogStats 컴포넌트, 교체된 admin/logs 페이지
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/37-log-viewer-ui/37-01-SUMMARY.md
@.planning/phases/37-log-viewer-ui/37-02-SUMMARY.md

@src/app/admin/logs/page.tsx
@src/app/admin/github/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: LogStats 컴포넌트 구현</name>
  <files>src/components/logs/LogStats.tsx</files>
  <action>
    로그 통계 표시 컴포넌트:

    1. Props 정의:
       - stats: LogStats (bySource, byLevel, total)
       - isLoading?: boolean

    2. UI 구성:
       - 전체 로그 수 표시
       - 소스별 개수 (docker/journal/app) - 작은 카드 또는 뱃지
       - 레벨별 개수 - 색상 코딩 (LOG_LEVEL_COLORS)
       - 로딩 스켈레톤 (isLoading 시)

    3. 스타일링:
       - 가로 배열 (flex-wrap)
       - 반응형: 모바일에서 2열, 데스크톱에서 inline
       - 컴팩트한 디자인 (공간 절약)
  </action>
  <verify>
    tsc --noEmit → 타입 에러 없음
    LogStats 컴포넌트가 export됨
  </verify>
  <done>LogStats가 소스별/레벨별 통계를 시각화한다</done>
</task>

<task type="auto">
  <name>Task 2: LogViewer 통합 컴포넌트 구현</name>
  <files>src/components/logs/LogViewer.tsx</files>
  <action>
    로그 뷰어 메인 컴포넌트 (모든 하위 컴포넌트 통합):

    1. 상태 관리:
       - filters: { sources, levels, search } 상태
       - isStreaming: 실시간 모드 on/off
       - pagination: { limit, offset }

    2. 훅 연결:
       - useLogs(filters) → 저장된 로그 조회
       - useLogStats() → 통계 조회
       - useLogStream({ ...filters, enabled: isStreaming }) → 실시간 로그

    3. 레이아웃:
       - 상단: 제목 + 통계 요약 (LogStats)
       - 중단: 필터 바 (LogFilter) + 실시간 토글 버튼
       - 하단: 로그 목록 (LogList)
         - 실시간 OFF: useLogs 결과 표시
         - 실시간 ON: useLogStream 결과 표시 (새 로그가 상단에 추가)

    4. 실시간 토글:
       - 버튼 클릭 시 isStreaming 토글
       - 실시간 ON: "실시간 로그 수신 중..." 인디케이터
       - 실시간 OFF: 페이지네이션 UI 표시

    5. 페이지네이션 (실시간 OFF 시):
       - "더 불러오기" 버튼 또는 무한 스크롤
       - offset 증가로 다음 페이지 로드

    참고 패턴:
    - @src/app/admin/github/page.tsx (레이아웃, Dynamic Import)
    - @src/components/alerts/AlertHistoryPanel.tsx (필터 + 목록 통합)
  </action>
  <verify>
    tsc --noEmit → 타입 에러 없음
    LogViewer가 export되고 모든 하위 컴포넌트 통합됨
  </verify>
  <done>LogViewer가 필터/통계/목록/실시간을 모두 통합한다</done>
</task>

<task type="auto">
  <name>Task 3: Admin 로그 페이지 교체</name>
  <files>src/app/admin/logs/page.tsx</files>
  <action>
    기존 더미 페이지를 실제 LogViewer로 교체:

    1. 기존 코드 제거:
       - sampleLogs, 하드코딩된 UI 삭제
       - services import 제거

    2. 새 구성:
       - 'use client' 지시어
       - AdminOnly 래퍼로 권한 체크
       - Dynamic Import로 LogViewer 지연 로딩
       - 페이지 헤더 (아이콘 + 제목 + 설명)

    3. 페이지 구조:
       ```tsx
       <AdminOnly fallback={<p>권한 없음</p>}>
         <div className="space-y-6">
           {/* 헤더 */}
           <div>
             <h1>Logs</h1>
             <p>실시간 로그 조회 및 검색</p>
           </div>

           {/* 로그 뷰어 */}
           <LogViewer />
         </div>
       </AdminOnly>
       ```

    참고 패턴:
    - @src/app/admin/github/page.tsx (AdminOnly, Dynamic Import, 헤더)
    - @src/app/admin/ports/page.tsx
  </action>
  <verify>
    npm run build → 빌드 성공
    /admin/logs 페이지 접근 가능
  </verify>
  <done>Admin 로그 페이지가 실제 데이터로 동작한다</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>로그 뷰어 대시보드 (/admin/logs)</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000/admin/logs (로그인 필요)
    3. 확인 사항:
       - 로그 목록이 표시된다 (또는 빈 상태 메시지)
       - 소스 필터 (docker/journal/app) 체크박스 동작
       - 레벨 필터 (info/warn/error 등) 동작
       - 검색 입력 후 필터링 동작
       - 실시간 토글 버튼 클릭 시 스트리밍 모드 전환
       - 통계 카드 (소스별/레벨별 개수) 표시
       - 스크롤 시 가상화된 목록이 부드럽게 동작
    4. 콘솔: WebSocket 연결/구독 로그 확인
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Plan 완료 전 확인:
- [ ] LogStats가 통계 시각화
- [ ] LogViewer가 모든 컴포넌트 통합
- [ ] admin/logs 페이지가 실제 로그 표시
- [ ] 실시간 스트리밍 토글 동작
- [ ] npm run build 성공
- [ ] 사용자 검증 완료 (checkpoint)
</verification>

<success_criteria>
- 모든 태스크 완료
- 사용자 검증 통과
- 로그 필터링/검색/실시간 스트리밍 동작
- 가상화된 목록으로 성능 확보
</success_criteria>

<output>
완료 후 `.planning/phases/37-log-viewer-ui/37-03-SUMMARY.md` 생성
</output>
