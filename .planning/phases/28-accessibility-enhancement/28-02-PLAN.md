# Plan 28-02: Semantic HTML & Motion Accessibility

## Overview

WCAG 레벨 AA 요구사항 충족을 위한 시맨틱 HTML 개선과 모션 접근성 구현.

## Goals

1. 네비게이션 시맨틱 구조 개선 (ul/li)
2. prefers-reduced-motion 지원
3. 색상 외 추가 시각적 표시 개선
4. ESLint jsx-a11y 플러그인 설정

## Tasks

### Task 1: Navigation Semantic Structure

네비게이션에 시맨틱 리스트 구조 적용.

**Files to modify**:
- `src/components/Header.tsx`
- `src/components/Sidebar.tsx`
- `src/components/MobileSidebar.tsx`

**Pattern**:
```tsx
// Before
<nav>
  {navItems.map(item => (
    <Link key={item.href} href={item.href}>
      {item.label}
    </Link>
  ))}
</nav>

// After
<nav aria-label="메인 네비게이션">
  <ul className="flex gap-4" role="list">
    {navItems.map(item => (
      <li key={item.href}>
        <Link
          href={item.href}
          aria-current={pathname === item.href ? 'page' : undefined}
        >
          {item.label}
        </Link>
      </li>
    ))}
  </ul>
</nav>
```

**Verification**:
- 스크린 리더가 "리스트, N개 항목"으로 읽음
- 현재 페이지에 aria-current="page" 적용

### Task 2: Reduced Motion Support

prefers-reduced-motion 미디어 쿼리 지원 추가.

**File**: `src/app/globals.css`

```css
/* 모션 감소 선호 시 애니메이션 비활성화 */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}
```

**File**: `src/hooks/useReducedMotion.ts`

```typescript
import { useEffect, useState } from 'react';

/**
 * 사용자의 모션 감소 선호 감지
 */
export function useReducedMotion(): boolean {
  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false);

  useEffect(() => {
    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)');
    setPrefersReducedMotion(mediaQuery.matches);

    const handleChange = (event: MediaQueryListEvent) => {
      setPrefersReducedMotion(event.matches);
    };

    mediaQuery.addEventListener('change', handleChange);
    return () => mediaQuery.removeEventListener('change', handleChange);
  }, []);

  return prefersReducedMotion;
}
```

**Framer Motion 통합**:
```tsx
const prefersReducedMotion = useReducedMotion();

<motion.div
  initial={prefersReducedMotion ? false : { opacity: 0 }}
  animate={{ opacity: 1 }}
  transition={prefersReducedMotion ? { duration: 0 } : { duration: 0.3 }}
>
```

**Verification**:
- 시스템 설정에서 모션 감소 활성화 시 애니메이션 비활성화

### Task 3: Status Indicators Enhancement

색상 외에 아이콘/텍스트로 상태 표시 보강.

**Files to modify**:
- `src/components/StatusBadge.tsx`
- `src/components/services/ServiceStatus.tsx`

**Pattern**:
```tsx
// Before (색상만으로 상태 표시)
<div
  className="h-2 w-2 rounded-full"
  style={{ backgroundColor: STATUS_COLORS[status] }}
/>

// After (아이콘 + 텍스트 추가)
<div className="flex items-center gap-1.5">
  <div
    className="h-2 w-2 rounded-full"
    style={{ backgroundColor: STATUS_COLORS[status] }}
    aria-hidden="true"
  />
  <StatusIcon status={status} className="h-3.5 w-3.5" aria-hidden="true" />
  <span className="sr-only">{STATUS_LABELS[status]}</span>
</div>

// StatusIcon 컴포넌트
function StatusIcon({ status }: { status: Status }) {
  switch (status) {
    case 'running': return <CheckCircle className="text-green-500" />;
    case 'stopped': return <XCircle className="text-red-500" />;
    case 'warning': return <AlertTriangle className="text-yellow-500" />;
    default: return <Circle className="text-gray-500" />;
  }
}
```

**Verification**:
- 색맹 사용자도 상태 구분 가능
- 스크린 리더가 상태 텍스트 읽음

### Task 4: ESLint jsx-a11y Plugin

접근성 자동 검사를 위한 ESLint 플러그인 설정.

**Install**:
```bash
npm install -D eslint-plugin-jsx-a11y
```

**File**: `eslint.config.mjs` 수정

```javascript
import jsxA11y from 'eslint-plugin-jsx-a11y';

export default [
  // ... existing config
  {
    plugins: {
      'jsx-a11y': jsxA11y,
    },
    rules: {
      // 권장 규칙
      'jsx-a11y/alt-text': 'error',
      'jsx-a11y/anchor-has-content': 'error',
      'jsx-a11y/aria-props': 'error',
      'jsx-a11y/aria-role': 'error',
      'jsx-a11y/aria-unsupported-elements': 'error',
      'jsx-a11y/click-events-have-key-events': 'warn',
      'jsx-a11y/heading-has-content': 'error',
      'jsx-a11y/html-has-lang': 'error',
      'jsx-a11y/img-redundant-alt': 'warn',
      'jsx-a11y/interactive-supports-focus': 'warn',
      'jsx-a11y/label-has-associated-control': 'warn',
      'jsx-a11y/no-noninteractive-element-interactions': 'warn',
      'jsx-a11y/no-static-element-interactions': 'warn',
      'jsx-a11y/role-has-required-aria-props': 'error',
      'jsx-a11y/role-supports-aria-props': 'error',
      'jsx-a11y/tabindex-no-positive': 'error',
    },
  },
];
```

**Verification**:
- `npm run lint` 실행 시 접근성 문제 감지
- 기존 코드 린트 오류 해결

### Task 5: Keyboard Drag Alternative

드래그 앤 드롭의 키보드 대체 경로 제공.

**File**: `src/components/admin/WidgetCustomizer.tsx`

**Pattern**:
```tsx
// 키보드로 위젯 순서 변경
const handleKeyDown = (e: React.KeyboardEvent, index: number) => {
  if (e.key === 'ArrowUp' && index > 0) {
    e.preventDefault();
    moveWidget(index, index - 1);
  }
  if (e.key === 'ArrowDown' && index < widgets.length - 1) {
    e.preventDefault();
    moveWidget(index, index + 1);
  }
};

// UI
<div
  role="listbox"
  aria-label="위젯 순서 변경"
  aria-describedby="widget-instructions"
>
  <p id="widget-instructions" className="sr-only">
    화살표 키로 위젯 순서를 변경할 수 있습니다
  </p>
  {widgets.map((widget, index) => (
    <div
      key={widget.id}
      role="option"
      tabIndex={0}
      aria-selected={selectedIndex === index}
      onKeyDown={(e) => handleKeyDown(e, index)}
    >
      {widget.name}
    </div>
  ))}
</div>
```

**Verification**:
- 키보드만으로 위젯 순서 변경 가능
- 스크린 리더 사용자도 조작 가능

### Task 6: Accessibility Tests

접근성 E2E 테스트 추가.

**File**: `e2e/accessibility.spec.ts`

```typescript
import { test, expect } from '@playwright/test';
import AxeBuilder from '@axe-core/playwright';

test.describe('Accessibility', () => {
  test('homepage has no WCAG violations', async ({ page }) => {
    await page.goto('/');

    const results = await new AxeBuilder({ page })
      .withTags(['wcag2a', 'wcag2aa'])
      .analyze();

    expect(results.violations).toEqual([]);
  });

  test('skip link works', async ({ page }) => {
    await page.goto('/');

    // Tab to skip link
    await page.keyboard.press('Tab');
    const skipLink = page.getByText('메인 콘텐츠로 건너뛰기');
    await expect(skipLink).toBeFocused();

    // Activate skip link
    await page.keyboard.press('Enter');
    const main = page.locator('#main-content');
    await expect(main).toBeFocused();
  });

  test('modal focus trap', async ({ page }) => {
    await page.goto('/teams');
    // ... 모달 포커스 트랩 테스트
  });
});
```

**Verification**:
- axe-core 자동 검사 통과
- 키보드 네비게이션 테스트 통과

## Dependencies

- 28-01 완료 (ARIA 기반)

## Verification Checklist

- [ ] Task 1: 네비게이션 시맨틱 구조
- [ ] Task 2: 모션 감소 지원
- [ ] Task 3: 상태 표시 개선
- [ ] Task 4: ESLint jsx-a11y 설정
- [ ] Task 5: 키보드 드래그 대체
- [ ] Task 6: 접근성 E2E 테스트
- [ ] `npm run lint` 통과
- [ ] `npm run build` 성공

## Commit Convention

```
feat(28-02): 시맨틱 HTML 개선 및 모션 접근성 구현
```
