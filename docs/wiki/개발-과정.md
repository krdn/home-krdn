# 개발 과정

이 문서는 home-krdn 프로젝트의 전체 개발 과정을 기록합니다.

## 1. 인터뷰 및 요구사항 수집

### 1.1 시스템 탐색

프로젝트 시작 전, 현재 시스템에서 운영 중인 서비스들을 파악했습니다:

- **AI 프로젝트**: ai-note-taking, claude-code-auto, linkedin, recursive-language-model
- **n8n 프로젝트**: gonsai2 (실행중), n8n (실행중), news-sentiment-analyzer2 (실행중), n8n-agent-generator
- **인프라**: open-webui, code-server, telegram-bot

총 19개의 Docker 컨테이너가 운영 중이었습니다.

### 1.2 요구사항 인터뷰

사용자와의 인터뷰를 통해 다음 요구사항을 확정했습니다:

| 질문 | 답변 |
|------|------|
| 대상 사용자? | 혼합 (관리 + 홍보) |
| 서비스 범위? | 모든 프로젝트 포함 |
| 디자인 스타일? | AI 추천 (테크 스타일) |
| 관리 기능 수준? | 풀 관리 기능 |
| 기술 스택? | Next.js (추천) |
| 인증? | 전체 공개 |
| 배포? | Docker |

---

## 2. 프로젝트 초기화 (Phase 1)

### 2.1 Next.js 프로젝트 생성

```bash
npx create-next-app@latest . --typescript --tailwind --eslint --app --src-dir
```

### 2.2 추가 패키지 설치

```bash
npm install @radix-ui/react-slot @radix-ui/react-tabs \
  @radix-ui/react-dialog @radix-ui/react-select \
  lucide-react zustand @tanstack/react-query \
  recharts class-variance-authority clsx tailwind-merge
```

### 2.3 디렉토리 구조 생성

```bash
mkdir -p src/{lib,types,config,hooks,stores}
mkdir -p src/components/{ui,layout,landing,services,admin,charts}
```

---

## 3. 기본 UI 컴포넌트 (Phase 1)

### 3.1 CSS 변수 설정 (globals.css)

다크모드를 기본으로 하는 색상 시스템 구축:

```css
:root {
  --background: 240 10% 3.9%;
  --foreground: 0 0% 98%;
  --primary: 0 0% 98%;
  /* ... */
}

.light {
  --background: 0 0% 100%;
  --foreground: 240 10% 3.9%;
  /* ... */
}
```

### 3.2 유틸리티 함수 (lib/utils.ts)

```typescript
export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs));
}
```

### 3.3 UI 컴포넌트

- `Button.tsx`: CVA(class-variance-authority) 기반 버튼
- `Card.tsx`: 카드 컴포넌트 (hover 효과 옵션)
- `Badge.tsx`: 상태/태그 배지
- `ThemeToggle.tsx`: 다크/라이트 모드 토글

---

## 4. 레이아웃 구현 (Phase 1)

### 4.1 Header.tsx

- 로고
- 네비게이션 (Home, Services, Admin)
- 테마 토글
- 모바일 메뉴

### 4.2 Footer.tsx

- 로고 및 설명
- 소셜 링크
- 저작권

### 4.3 루트 레이아웃 (layout.tsx)

```tsx
<html lang="ko" suppressHydrationWarning>
  <body>
    <Header />
    <main>{children}</main>
    <Footer />
  </body>
</html>
```

---

## 5. 서비스 설정 정의 (Phase 2)

### 5.1 타입 정의 (types/service.ts)

```typescript
export interface Service {
  id: string;
  name: string;
  description: string;
  category: ServiceCategory;
  status: ServiceStatus;
  techStack: string[];
  port?: number;
  // ...
}
```

### 5.2 서비스 데이터 (config/services.ts)

11개 서비스의 상세 정보를 정의했습니다. 헬퍼 함수도 포함:

```typescript
export function getServiceById(id: string): Service | undefined;
export function getServicesByCategory(category: string): Service[];
export function getRunningServices(): Service[];
```

---

## 6. 랜딩 페이지 (Phase 2)

### 6.1 Hero 섹션

- 그라데이션 배경
- 실행 중인 서비스 수 표시
- CTA 버튼

### 6.2 ServiceCategories 섹션

- 3개 카테고리 카드 (AI, n8n, Infrastructure)
- 각 카테고리별 서비스 수 및 실행 상태

### 6.3 FeaturedServices 섹션

- 실행 중인 서비스 카드
- 기술스택 배지
- 외부 링크

---

## 7. 서비스 페이지 (Phase 2)

### 7.1 서비스 목록 (/services)

- 카테고리 필터 탭
- Running only 필터
- 검색 기능
- ServiceCard 그리드

### 7.2 서비스 상세 (/services/[slug])

- SSG로 빌드 시 정적 생성
- 서비스 정보 카드
- 기술스택, 기능, 컨테이너 목록

---

## 8. 관리 대시보드 (Phase 3)

### 8.1 Admin 레이아웃

- Sidebar (데스크톱)
- MobileSidebar (모바일 탭)

### 8.2 대시보드 메인 (/admin)

- 통계 카드 (Services, Containers, CPU, Memory)
- 실행 중인 서비스 목록
- 빠른 링크

### 8.3 서비스 관리 (/admin/services)

- 필터 (all/running/stopped)
- 시작/중지/재시작 버튼

### 8.4 컨테이너 관리 (/admin/containers)

- 서비스별 컨테이너 그룹화
- 개별 컨테이너 제어

### 8.5 로그 조회 (/admin/logs)

- 컨테이너 선택
- 로그 출력 (샘플 데이터)
- Auto-refresh 토글

### 8.6 시스템 모니터링 (/admin/system)

- CPU/Memory/Disk 프로그레스 바
- 시스템 정보

---

## 9. Docker 배포 (Phase 4)

### 9.1 next.config.ts

```typescript
const nextConfig: NextConfig = {
  output: "standalone",
};
```

### 9.2 Dockerfile

멀티스테이지 빌드:
1. deps: 의존성 설치
2. builder: 빌드
3. runner: 프로덕션 실행

### 9.3 docker-compose.yml

- home-krdn: Next.js 앱 (포트 3005)
- nginx: 리버스 프록시 (포트 8082)

### 9.4 nginx.conf

- 업스트림 설정
- 프록시 패스
- 정적 파일 캐싱

---

## 10. 문제 해결

### 10.1 Button asChild 오류

**문제**: Radix Slot 컴포넌트가 단일 자식만 허용

**해결**: asChild일 때 Slot만 사용, 일반 버튼은 button 태그 사용

```typescript
if (asChild) {
  return <Slot>{children}</Slot>;
}
return <button>{children}</button>;
```

### 10.2 Lucide 아이콘 타입 오류

**문제**: 동적 아이콘 가져오기 시 타입 불일치

**해결**: 아이콘 매핑 파일 생성 (`lib/icons.ts`)

```typescript
const iconMap: Record<string, LucideIcon> = {
  Box, FileText, Code, // ...
};

export function getIcon(name?: string): LucideIcon {
  return iconMap[name || ''] || Box;
}
```

### 10.3 Service path 필수 오류

**문제**: 일부 서비스에 path 누락

**해결**: path를 optional로 변경 (`path?: string`)

---

## 11. 최종 결과

### 생성된 파일 수

- 페이지: 9개
- 컴포넌트: 15개
- 유틸리티/설정: 6개
- Docker 설정: 3개

### 빌드 결과

```
Route (app)
├ ○ /
├ ○ /admin (5 pages)
├ ○ /services
└ ● /services/[slug] (11 pages)

○  (Static)
●  (SSG)
```

### 접속 정보

| 환경 | URL |
|------|-----|
| 개발 | http://localhost:3005 |
| 프로덕션 | https://home.krdn.kr |
